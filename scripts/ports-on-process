#!/bin/bash

set -euo pipefail

# Check if running as root
if [ "$(id -u)" -ne 0 ]; then
    echo "Error: This script requires sudo privileges"
    exit 1
fi

if [ $# -eq 0 ]; then
    lsof -iTCP -sTCP:LISTEN -n -P
elif [ $# -eq 1 ]; then
    pattern="$1"
    lsof -iTCP -sTCP:LISTEN -n -P | grep -i --color "$pattern"
fi
